<% layout('layout/boilerplate') -%>

<div
  id="carouselExampleControls"
  class="carousel slide"
  data-bs-ride="carousel"
>
  <div class="carousel-inner">
    <div class="carousel-item active mainImg" data-bs-interval="2000">
      <img
        src="https://res.cloudinary.com/ddw8h2m1v/image/upload/v1670275673/tarpitCafe/P1040409-1_1_wnpcb5_c73f84_cuefz6.png"
        alt="..."
      />
    </div>
    <% uri.forEach((img) =>{ %>
    <div class="carousel-item mainImg" data-bs-interval="2000">
      <img src="<%=img%>" alt="..." />
    </div>
    <% }) %>
  </div>
  <button
    class="carousel-control-prev"
    type="button"
    data-bs-target="#carouselExampleControls"
    data-bs-slide="prev"
  >
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button
    class="carousel-control-next"
    type="button"
    data-bs-target="#carouselExampleControls"
    data-bs-slide="next"
  >
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
<div class="wrapper">
  <a href="/blogs">
    <button class="shopBtn">
      Checkout Blogs
      <span></span>
      <span></span>
      <span></span>
      <span></span>
    </button>
  </a>
</div>
<div class="container">
  <h1>Shop our Products</h1>
  <div class="category">
    <h3>Choose Categories</h3>
    <div class="dropForm">
      <i class="fa-solid fa-circle-chevron-down"></i>
    </div>
    <div id="formQuery" style="display: none">
      <form action="/products">
        <div>
          <% category.forEach(cat=>{ %>
          <input
            type="checkbox"
            name="query"
            id="goods"
            class="filterbox"
            value="<%=cat.name%>"
          />
          <% }) %>
        </div>
        <div class="filterLabel">
          <% category.forEach(cat=>{ %>
          <label class="filterbox" for="<%=cat.name%>"><%=cat.name%></label>
          <% }) %>
        </div>
        <div style="text-align: center">
          <button class="btn">Filter</button>
        </div>
      </form>
    </div>
  </div>
  <hr style="padding-bottom: 20px; color: rgb(1, 1, 109)" />
  <% if(category) {%>
  <h2 style="text-align: center; margin-bottom: 50px"><%=cat%></h2>
  <% }else{ %>
  <h2 style="text-align: center">All</h2>
  <% } %>
  <div class="cardContainer">
    <% for(let product of products) {%>
    <div class="card cardShape" style="border-radius: 0%">
      <a href="/products/<%=product._id%>">
        <% if(product.image.length > 1) {%>
        <div
          id="carouselExampleFade"
          class="carousel slide carousel-fade"
          data-bs-ride="carousel"
        >
          <div class="carousel-inner">
            <div class="carousel-item active">
              <img
                src="<%=product.image[0].url%>"
                class="card-img-top"
                style="height: 25rem; border-radius: 0%; object-fit: cover"
                alt="My product"
              />
            </div>
            <% for(let img of product.image){ %>
            <div class="carousel-item">
              <img
                src="<%=img.url%>"
                class="card-img-top"
                style="height: 25rem; border-radius: 0%; object-fit: cover"
                alt="My product"
              />
            </div>
            <% }%>
          </div>
        </div>
        <% } else{ %> <% for(let img of product.image){ %>

        <img
          src="<%=img.url%>"
          class="card-img-top"
          style="height: 25rem; border-radius: 0%; object-fit: cover"
          alt="My product"
        />
        <%} }%>
        <div class="card-text">
          <h4 style="margin-bottom: 0"><%=product.title%></h4>
          $<%=product.price%>
        </div>
      </a>
    </div>
    <%} %>
  </div>
</div>
